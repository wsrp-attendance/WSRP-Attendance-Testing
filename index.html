<!DOCTYPE html>
<html>
<head>
  <title>Check-In</title>
</head>
<body>
  <h2>WSRP STUDENT/Mentor Check-In-Hopefully</h2>
  <p id="status">Getting location...</p>

  <script>
    const webAppUrl = 'https://script.google.com/macros/s/AKfycbwTzllad6I0TkaIPRb0Thju5f3JeR5eAp7_xoXeoAXHdKyYnQ8DPbBr-AJjpMrXJTn5/exec';
    const uid = 'UID-' + Math.random().toString(36).substring(2, 10);

    function postCheckIn(lat, lng) {
      const formData = new FormData();
      formData.append('uid', uid);
      formData.append('latitude', lat);
      formData.append('longitude', lng);

     fetch(webAppUrl, {
  method: 'POST',
  body: formData,
})
.then(response => response.text())
.then(text => {
  document.open();
  document.write('<h2>' + text + '</h2>');
  document.close();
})
.catch(err => {
  document.getElementById('spinner').style.display = 'none';
  document.getElementById('status').textContent = '❌ Error: ' + err.message;
});
    }

    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(
        position => {
          const lat = position.coords.latitude.toFixed(6);
          const lng = position.coords.longitude.toFixed(6);
          postCheckIn(lat, lng);
        },
        error => {
          document.getElementById('status').textContent = '❌ Unable to get location.';
        }
      );
    } else {
      document.getElementById('status').textContent = '❌ Geolocation not supported.';
    }
  </script>
</body>
</html>
